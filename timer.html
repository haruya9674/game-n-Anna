<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Life Timer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#f7faff,#eef6ff);
  padding:20px;
  max-width:560px;
  margin:auto;
}
h1{text-align:center;margin-bottom:10px;}
.lang{
  text-align:center;
  margin-bottom:16px;
}
.lang button{
  width:auto;
  margin:0 4px;
  padding:6px 12px;
  font-size:14px;
}
.card{
  background:white;
  padding:18px;
  border-radius:18px;
  box-shadow:0 6px 14px rgba(0,0,0,.15);
  margin-bottom:16px;
}
input,button{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:14px;
  border:1px solid #ccc;
  margin-bottom:10px;
}
button{
  background:white;
  cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,.15);
}
button:active{transform:scale(0.97);}
.event{
  margin-top:12px;
  padding-top:12px;
  border-top:1px solid #eee;
}
.title{
  font-weight:bold;
  font-size:18px;
  margin-bottom:6px;
}
.time{
  font-size:15px;
  line-height:1.6;
}
.small{
  font-size:13px;
  color:#666;
}
.back{
  text-align:center;
  margin-top:20px;
}
a{text-decoration:none;color:#333;}
</style>
</head>

<body>

<h1 id="appTitle">⏱️ Counter Timer</h1>

<div class="lang">
  <button onclick="setLang('ja')">日本語</button>
  <button onclick="setLang('en')">EN</button>
  <button onclick="setLang('ko')">한국어</button>
</div>

<div class="card">
  <input id="title" placeholder="">
  <input type="date" id="date">
  <button onclick="addEvent()" id="addBtn"></button>
</div>

<div id="list"></div>

<div class="back">
  <a href="index.html" id="backBtn"></a>
</div>

<script>
let lang = localStorage.getItem("lang") || "en";

const text = {
  ja:{
    app:"⏱️ カウンタータイマー",
    title:"イベント名（誕生日・記念日・予定）",
    add:"追加",
    since:"経過",
    until:"まで残り",
    days:"日",
    back:"← メインメニューへ戻る"
  },
  en:{
    app:"⏱️ Counter Timer",
    title:"Event title (Birthday, Memory, Goal)",
    add:"Add Event",
    since:"Since",
    until:"Until",
    days:"days",
    back:"← Back to Main Menu"
  },
  ko:{
    app:"⏱️ 카운터 타이머",
    title:"이벤트 이름 (생일, 추억, 목표)",
    add:"추가",
    since:"이후",
    until:"까지",
    days:"일",
    back:"← 메인 메뉴로"
  }
};

let events = JSON.parse(localStorage.getItem("lifeEvents") || "[]");

function setLang(l){
  lang=l;
  localStorage.setItem("lang",lang);
  applyLang();
}

function applyLang(){
  document.documentElement.lang = lang;
  appTitle.innerText = text[lang].app;
  title.placeholder = text[lang].title;
  addBtn.innerText = text[lang].add;
  backBtn.innerText = text[lang].back;
}

function addEvent(){
  const t = title.value.trim();
  const d = date.value;
  if(!t || !d) return;

  events.push({title:t,date:d});
  localStorage.setItem("lifeEvents",JSON.stringify(events));
  title.value="";
  date.value="";
  render();
}

function render(){
  list.innerHTML="";
  events.forEach((e,i)=>{
    const div=document.createElement("div");
    div.className="card event";
    div.innerHTML=`
      <div class="title">${e.title}</div>
      <div class="time" id="t${i}">—</div>
      <div class="small">${e.date}</div>
    `;
    list.appendChild(div);
  });
}

function update(){
  const now=new Date();
  events.forEach((e,i)=>{
    const target=new Date(e.date);
    let diff=Math.floor((now-target)/1000);
    let label=text[lang].since;

    if(diff<0){
      diff=Math.abs(diff);
      label=text[lang].until;
    }

    const days=Math.floor(diff/86400);
    diff%=86400;
    const h=Math.floor(diff/3600);
    diff%=3600;
    const m=Math.floor(diff/60);
    const s=diff%60;

    const el=document.getElementById("t"+i);
    if(el){
      el.innerHTML=
        `<b>${label}</b><br>
         ${days.toLocaleString()} ${text[lang].days}<br>
         ${h}h ${m}m ${s}s`;
    }
  });
}

applyLang();
render();
update();
setInterval(update,1000);
</script>

</body>
</html>
